lab 07
zadanie 1.

1.
select * from kreatura k 
left join uczestnicy u on k.idKreatury=u.id_uczestnika
where u.id_uczestnika is null;

2.
select w.nazwa, sum(e.ilosc) from wyprawa w
inner join uczestnicy u on w.id_wyprawy=z.id_wyprawy
right join ekwipunek e on z.id_uczestnika=e.idKreatury
group by w.id_wyprawy;
Zadanie 2.

1.
select concat(nazwa, ' ->' ,rodzaj) from kreatura;
select w.nazwa, count(u.id_uczestnika), group_concat(k.nazwa)
from wyprawa w 
inner join uczestnicy u on w.id_wyprawy=u.id_wyprawy
inner join kreatura k on k.idKreatury=u.id_uczestnika
group by w.id_wyprawy;

2.
select w.data_rozpoczecia, w.nazwa, k.nazwa, ew.kolejnosc 
from kreatura k 
inner join wyprawa w on k.idKreatury=w.kierownik
inner join etapy_wyprawy ew on ew.id_wyprawy=w.id_wyprawy
inner join sektor s on ew.sektor=s.id_sektora
order by w.data_rozpoczecia, ew.kolejnosc;

Zadanie 3.

1. 
select s.nazwa if(count(ew.sektor)is null, 0,count(ew.sektor)) 
from sektor s
left join etapy_wyprawy ew on s.id_sektora=ew.sektor
group by s.id_sektora;

2.
select k.nazwa, if(id_wyprawy > 0 (concat(nazwa, 'bral udzial w wyprawie')) 
from kreatura k
left join uczestnicy u on k.idKreatury=u.id_uczestnika;

Zadanie 4.

1.
select id_wyprawy, sum(lenght(dziennik)) suma_dlugosci 
from etapy_wyprawy group by id_wyprawy
having suma_dlugosci < 400;

select length("   ")
select char_length("   ")
select length(nazwa) + length(rodzaj) from kreatura;

4.2

select w.nazwa, sum(e.ilosc*z.waga)/ count(distinct u.id_uczestnika) from uczestnicy u 
left join wyprawa w on w.id_wyprawy=u.id_wyprawy
left join  kreatura k on k.idKreatury=u.id_uczestnika
left join ekwipunek e on e.idKreatury=k.idKreatury
left join zasob z on z.id.Zasobu=e.idZasobu
group by w.id_wyprawy;


