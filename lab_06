Zadanie 1.
1.
select sum(udzwig) from kreatura;
select rodzaj, sum(udzwig) from kreatura group by rodzaj;
select count(*) from kreatura;
select count(distinct rodzaj) from kreatura;
2.
select avg(waga) from kreatura;
select rodzaj, avg(waga) from kreatura group by rodzaj;
select rodzaj, avg(waga), count(rodzaj) from kreatura group by rodzaj;
3.
select rodzaj, avg(year(now()) - year(dataUr))
from kreatura group by rodzaj;

Zadanie 2.
select rodzaj, avg(waga) from kreatura group by
rodzaj having avg(waga) > 50;
1.
select rodzaj,sum(waga) from zasob group by rodzaj;
2.
select nazwa, avg(waga) from zasob where ilosc >=4 group by 
nazwa having avg(waga) > 10;
3.
select rodzaj, count(distinct nazwa) from zasob group by rodzaj 
having min(ilosc) > 1;

Zadanie 3.
1.
select * from kreatura, ekwipunek
where kreatura.idKreatury=ekwipunek.idKreatury;
select * from kreatura k, ekwipunek e
where k.idKreatury=e.idKreatury;
select * from kreatura k
inner join ekwipunek e on k.idKreatury=e.idKreatury;
2.
select nazwa, sum(ilosc) from kreatura, ekwipunek where 
kreatura.idKreatury=ekwipunek.idKreatury group by nazwa;
3.
select k.nazwa,z.nazwa from kreatura k
INNER JOIN ekwipunek e ON k.idKreatury=e.idKreatury
INNER JOIN zasob z ON e.idZasobu=z.idZasobu;

select k.nazwa, k.idKreatury, e.idKreatury from kreatura k
left join ekwipunek e on k.idKreatury=e.idKreatury
where e.idKreatury is null;

Zadanie 4.
select k1.nazwa, k2.nazwa kreatura k1 inner join kreatura k2 on k2.idKreatury-k1.idKreatury =5;

select * from kreatura k
inner join ekwipunek e on k.idKreatury=e.idKreatury
inner join zasob z on e.idZasobu=z.idZasoby
where z.rodzaj='jedzenie' order by k.dataUr desc limit 5;

select * from kreatura k 
inner join ekwipunek e on k.idKreatury=e.idKreatury 
where k.rodzaj not in ('malpa','waz');

5.1
select k.rodzaj, sum(e.ilosc), avg(e.ilosc*z.waga) from kreatura k
inner join ekwipunek e on k.idKreatury=e.idKreatury
inner join zasob z on e.idZasobu=z.idZasobu
where k.rodzaj not in ('malpa', 'waz') and e.ilosc < 30
group by k.rodzaj;

5.2
select k.nazwa, k.rodzaj, k.dataUr from kreatura k,
(select rodzaj, min(dataUr) as min, max(dataUr) as max from kreatury 
group by rodzaj) as pod
where k.dataUr=pod.min or k.dataUr=pod.max and k.rodzaj=pod.rodzaj;
